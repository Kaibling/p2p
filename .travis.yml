language: go
go:
  - 1.11.5

jobs:
  include:
    - stage: unit tests
      script: 
        - go test ./... -v -covermode=count -coverprofile=coverage.out
        - $HOME/gopath/bin/goveralls -coverprofile=coverage.out -service=travis-ci
      os: 
        - linux
        - windows
      before_install:
        - go get golang.org/x/tools/cmd/cover
        - go get github.com/mattn/goveralls
        - go get github.com/kaibling/p2p/p2pServer
        - go get github.com/kaibling/p2p/libs/util
        - go get github.com/kaibling/p2p/libs/Node
    - stage: Linux release
      if: branch = master
      script: 
        - go build cmd/p2pServer/main.go
        - ls
      os:  linux

    - stage: Windows release
      if: branch = master
      script: 
        - go build cmd/p2pServer/main.go
        - ls
      os:  windows

